# PTT 爬蟲

## 📋 專案說明

這是一個專門爬取 PTT Drink 版面的 Python 爬蟲工具。**簡化版本，無會話恢復和備份功能**，程式中斷即停止，重新執行即從頭開始。

### ✨ 主要特色

- 🎯 **專注爬取**: 固定爬取 PTT Drink 版面
- 🚀 **簡單易用**: 輸入頁數即可開始爬取
- 📊 **資料儲存**: 自動儲存為 CSV 格式
- 🛡️ **錯誤處理**: 基本的錯誤記錄和處理
- ⚡ **無備份**: 程式簡潔，中斷即停止

### ⚠️ 重要說明

- **無會話恢復**: 程式中斷後無法從中斷處繼續
- **無自動備份**: 不會產生中間備份檔案
- **固定版面**: 只能爬取 Drink 版面
- **重新開始**: 每次執行都從頭開始爬取

## 🚀 快速開始

### 1. 安裝 uv (Python 套件管理工具)

#### macOS/Linux
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

#### 使用 Homebrew (Mac 推薦)
```bash
brew install uv
```

### 2. 克隆專案
```bash
git clone <你的專案網址>
cd crawler_ptt
```

### 3. 初始化環境
```bash
# 使用 pyproject.toml 同步依賴套件和建立虛擬環境
uv sync
```

### 4. 執行爬蟲

#### 方法一：使用 uv 執行
```bash
uv run python main.py
```

#### 方法二：啟動虛擬環境後執行
```bash
source .venv/bin/activate  # macOS/Linux
# 或
.venv\Scripts\activate     # Windows

python main.py
```

### 5. 操作流程
1. 程式啟動後會提示輸入要爬取的頁數
2. **直接按 Enter**: 爬取所有頁面（預設行為，會爬取整個版面）
3. **輸入數字**: 爬取指定頁數（例如輸入 "10" 爬取 10 頁）
4. 程式會自動爬取 Drink 版面
5. 完成後資料會儲存在 `data/` 目錄

## 📁 專案結構

```
ptt_crawler/
├── main.py                      # 主程式入口
├── ptt_crawler.py              # 爬蟲核心模組
├── pyproject.toml             # uv 專案設定與依賴管理
├── .python-version            # Python 版本指定
├── data/                      # 輸出資料目錄
│   ├── ptt_Drink_YYYYMMDD_HHMMSS.csv  # 主要資料檔案
│   └── ptt_Drink_latest.csv   # 最新資料檔案
└── errors/                    # 錯誤記錄目錄
    └── Drink/
        └── page_errors.log    # 頁面錯誤記錄
```

## 🎯 使用範例

### 爬取指定頁數
```bash
$ uv run python main.py
=== PTT Drink 版爬蟲程式 ===
🚀 啟動 PTT 爬蟲
🎯 固定爬取版面: Drink

請輸入要爬取的頁數 (直接按 Enter 爬取所有頁面): 5

📝 將爬取 Drink 版 5 頁
==================================================
🌟 開始爬取 Drink 版，共 5 頁
==================================================
自動偵測起始頁面: 846

--- 處理第 1/5 頁 (頁面編號: 846) ---
第 1 頁完成，成功取得 20 筆資料
...
🎉 爬取任務完成！
```

### 爬取所有頁面（預設）
```bash
$ uv run python main.py
=== PTT Drink 版爬蟲程式 ===
🚀 啟動 PTT 爬蟲
🎯 固定爬取版面: Drink

請輸入要爬取的頁數 (直接按 Enter 爬取所有頁面): [直接按 Enter]

📝 將爬取 Drink 版所有頁面
⚠️  這可能需要很長時間，請耐心等候
==================================================
🌟 開始爬取 Drink 版的所有頁面
==================================================
自動偵測起始頁面: 846
📊 預估最多爬取約 846 頁

--- 處理第 1 頁 (頁面編號: 846) ---
...
```

## 📊 輸出資料格式

爬取的資料會包含以下欄位：

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 標題 | 文章標題 | [情報] 星巴克新飲品上市 |
| 作者 | 作者 | username123 |
| 版名 | 版面名稱 | Drink |
| 日期 | 發文時間 | Mon Jan 15 14:30:25 2024 |
| 內文 | 文章內容 | 今天發現星巴克... |
| 文章編碼 | 文章唯一編碼 | M.1640420425.A.123 |
| 分類 | 文章分類 | [情報] |
| IP位置 | 發文者IP | 123.456.789.123 |
| 總留言數 | 推文總數 | 25 |
| 推 | 推文數 | 20 |
| 噓 | 噓文數 | 3 |
| 中立 | 中立推文數 | 2 |
| 文章分數（正-負） | 推噓分數 | 17 |
| 所有留言 | 完整推文內容 | 推 user1: 讚...|

## 🛠️ 環境需求

- **Python**: 3.8+ (推薦 3.10+)
- **套件管理**: uv (推薦)
- **依賴管理**: 使用 `pyproject.toml` 管理依賴套件

### 主要依賴套件
- `requests`: HTTP 請求
- `beautifulsoup4`: HTML 解析
- `pandas`: 資料處理
- `fake-useragent`: 請求偽裝

## ⚠️ 注意事項

1. **合理使用**: 請適度使用，避免過度頻繁的請求
2. **遵守規範**: 請遵守 PTT 的使用規範
3. **網路穩定**: 建議在穩定的網路環境下使用
4. **簡化版本**: 此版本不支援會話恢復，中斷後需重新開始

## 🐛 常見問題

### Q: 爬取過程中出現錯誤怎麼辦？
A: 檢查 `errors/Drink/page_errors.log` 查看詳細錯誤訊息

### Q: 程式中斷後可以繼續嗎？
A: 不行，這是簡化版本，中斷後需要重新開始

### Q: 可以爬取其他版面嗎？
A: 此版本固定只能爬取 Drink 版面

### Q: 資料儲存在哪裡？
A: 儲存在 `data/` 目錄下，包含時間戳記檔案和最新檔案
